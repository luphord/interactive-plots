<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>Black-Scholes Model</title>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="assets/vendor/css/jsxgraph.css" rel="stylesheet" type="text/css" />
    <script src="assets/vendor/js/jsxgraphcore.js" charset="UTF-8"></script>
    <script src="assets/vendor/js/gaussian-analytics.js"></script>
  </head>
  <body>

  <div id="jxgbox" class="jxgbox" style="max-width:600px; margin: auto; aspect-ratio: 1/1;"></div>


  <script>
    var inTheMoneyAttrs = {
      straightFirst: false,
      straightLast: false,
      strokecolor: 'grey',
      strokewidth: 3
    };
    var outOfTheMoneyAttrs = {
      straightFirst: false,
      straightLast: true,
      strokecolor: 'grey',
      strokewidth: 3
    };
    var optionPriceAttrs = {
      strokecolor: 'orange',
      strokewidth: 3
    };
    var board = JXG.JSXGraph.initBoard('jxgbox', {
      boundingbox: [-10, 100, 200, -10],
      axis: true,
      title: 'Black-Scholes Model<',
      showCopyright: false
    });
    var xAxisPositive = board.create('line',
      [[0.00001, 0], [100, 0]],
      { visible: false, straightFirst: false }
    );
    var strike = board.create('glider',
      [100, 0, xAxisPositive],
      { face: '<>', size: 7, name: 'strike' }
    );
    var volatility= board.create('slider',
      [[10, 70], [70, 70], [0, 0.1, 1]],
      { name: 'volatility' }
    );
    var payoff = board.create('group',
      [
        board.create('line',
          [[0, 0], [() => strike.X(), 0]],
          inTheMoneyAttrs
        ),
        board.create('line',
          [[() => strike.X(), 0], [() => strike.X() + 100, 100]],
          outOfTheMoneyAttrs
        )
      ]);
    var maxSpot = function(K, T, sigma, q, r) {
      const factor = 1.8; // determined by observation
      return K * Math.exp(factor * sigma * Math.sqrt(T) - (r - q - sigma*sigma / 2) * T);
    };
    board.create('functiongraph',
      [
        spot => eqBlackScholes(
                  spot,
                  strike.X(),
                  1,
                  volatility.Value(),
                  0,
                  0
                ).call.price,
        0,
        () => maxSpot(strike.X(), 1, volatility.Value(), 0, 0)
      ],
      optionPriceAttrs
    );
  </script>

  </body>
</html>